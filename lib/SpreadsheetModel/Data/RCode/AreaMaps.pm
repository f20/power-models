package SpreadsheetModel::Data::RCode::AreaMaps;

=head Copyright licence and disclaimer

Copyright 2014-2017 Franck Latrémolière, Reckon LLP and others.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright notice,
this list of conditions and the following disclaimer.

2. Redistributions in binary form must reproduce the above copyright notice,
this list of conditions and the following disclaimer in the documentation
and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY AUTHORS AND CONTRIBUTORS "AS IS" AND ANY
EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL AUTHORS OR CONTRIBUTORS BE LIABLE FOR ANY
DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

=cut

use warnings;
use strict;
use utf8;

local undef $/;
binmode DATA, ':utf8';
my $rCode = <DATA>;

sub rCode {
    my ( $self, $script ) = @_;
    return '' if $script->{$self};
    $script->{$self} = 1;
    $rCode;
}

1;

__DATA__
dno.areas<-c('ENWL', 'NPG Northeast', 'NPG Yorkshire', 'SPEN SPD', 'SPEN SPM', 'SSEN SEPD', 'SSEN SHEPD', 'UKPN EPN', 'UKPN LPN', 'UKPN SPN', 'WPD EastM', 'WPD SWales', 'WPD SWest', 'WPD WestM');

map.England.Wales.Scotland <- function () {
    data.frame(
z=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14),
x=c(413,417,417,419,419,420.286,420,420,411,411,411,401,391,390.75,389,385,385,375,376,387.094,384.843,379.864,379,378.605,385,384,384,369.793,367.545,376,376,378,378,378,372.77,366.98,366,366,366,356,356,348,348,348,333,333,319,319,312,312,311.575,310,309,308.167,299,298,298,297.111,294,297,303,307,311.474,317,317,321,321,321,321,338.742,331,330,330,331,337,339,339,342,342,342,356,356,366,366,379,382,382,392,392,405,409.8,NA,340,331.75,333.324,340.676,340,340,478,478.643,479.429,480,482,486,488,497.839,513.943,511,511,514.523,515,513.5,512,503.444,498,498,495,495,495,492,492,491.429,490,490,478,478,477.5,476.5,475,470.462,452.695,443.4,441.638,441,441,435.25,430.6,428,426,426,423,423,422,418,418,418,409.383,403,403,385,382.938,381,381,371,371,360,359,360,363,371.284,367.334,372.256,378.591,380.917,380,380,380,380,388.854,384,384,384,382,381,381,386.268,398,398,410,410.824,416.857,418,438.008,440,441,441,452.818,454.333,471,NA,517,517,517,517,515.833,515.3,518.231,432,432,445,445,451,469,469,478,478,488.022,504,510,510,526.112,528,528,528,537,537,541,541,541,540,534,534,534,529.39,520.478,515.3,525,525,525,523,519,519,516,515.615,511,511,513.943,497.839,488,486,482,480,479.429,478.643,478,471,454.333,452.818,441,441,440,438.008,418,416.857,404.222,394,394,394,389,384,382,383,387.094,376,375,385,385,389,390.75,391,402,402,409,409,409,421.639,419,419,420,424,424,424,432,228.537,234,234,245,245,245,263,269,277,277,293.889,297,297,297,317,322.5,333,333,348,348,348,351.254,352,352,352,359,370,370,376,376,376,385,403,403,413,413,398.923,394,392,392,374.5,372,372,359.933,357,357,362,363,358,358,348,344,342,333,333,327.4,319,319,316.653,312,301,301,294,294,294,278.711,265,265,260,260,260,251,251,238,238,238,234,236,236,236,220,220,218,218,217,217,217,222,229.619,226,226,220,220,218.182,210,210,204.393,198,197,196,197,199,199,206.049,209,213,NA,250,239.538,248.651,254.127,250,250,263,264,264,280,292,300,300,308,308,321,321,322,329,334.625,344.667,357,357,360,373,378,379,380.91,381.958,383.441,384,383.477,382,382,379,366,366,356,356,342,342,342,339,339,337,334.13,333,332,329,329,327,327,318.161,316.607,303.217,292.554,275,275,267,264,263,247,247,245,242,242,237,234,229,222,221.556,221,221,226,227,233,233,240.565,234.556,227,217,211,229,229,231,245,255.375,256.951,256,256,256,258.516,256.416,250,250,248,248,255,255,257,382,382,392,392,396,402,402,416.389,418.828,430,430,449,450,455,455,457,463.667,480.652,484,486,504,504,505,506,504,504,509,509,509,509,511,511,510,510,502.527,499.341,499.762,515.171,517,516,518,518.375,514,514,514,503.6,491,491,478.043,465.051,468,468,468,468,468,452.889,449,449,449,444,430,430,430,424.5,419,408.571,402,399,394,394,391.727,381,381,380,371,371,371,376.452,369,369,359,358,358,353.5,349,348,348,350,352,352,353,353,367,367,367,440,443,443,450,450,448.023,456,456,456,468,468,455.81,462,463,463,464,461,461,461,453,453,446,446,446,436,436,436,423,423,423,428.858,420.217,417,417,419,422,422,436,436,437,437,438,438,438,440,NA,173,173,175,178.031,195,195,195,203,203,204,205,205,202.75,217,217,217.173,217.689,216.25,217.944,218,218,220,220,236,236,234,238,238,238,249.103,250.709,254.751,256,256,266.323,278.711,280.029,288.625,291.102,294,294,294,301,301,312,316.653,319,319,327.4,333,333,342,344,345.385,347,347,357,357,364,364,364,368,372.474,381,381,383,383,386,386,387,388.895,396,396,397,399.525,401.417,409,413,413,413,413,413,409,409,409,404,400,396,396,392,382,381,381,376.325,365.417,359,359,349,346,335.93,323,323,321,310,310,304.072,289.28,292,293,288.136,290.722,303,303,303,311,311,311,314.542,327,327,332,332,334,337,338,338,336.095,337.2,345,345,345,347.647,358,358,367,367,367,367,373,376,367,367,362.807,360.278,349,349,344,342,344,334,325,325,324,323,323,328.5,327,327,309,309,302,302,287,282,282,282,267.25,257,257,257,243.364,239,235,220.774,219,219,219,216,214,201,201,196,197.421,187,187,180,180,174,174,174,173,173,173,173,173,173,173,161,161,161,149,144,141,122,122,112,112,116,116,116,125.276,132,140,145,140,148.96,156,147,162.522,162.244,152.539,142,143,137.48,122,122,135,141.229,134.857,131,128,127,130,130,138,138,138,153,153,161.534,162.55,173,173,173,176.238,172.817,164,164,163,159.615,146.529,142,134,134,141,123,123,122,116,116,116,116,129,129,129,140,140,144,144,144,144,164,164,146,152,155.445,170.59,165,164,164,165.76,163,166,166,172,172,172,NA,328,331,340.297,334.065,NA,69,71,79,79,77.356,83,86,90.31,96,96,105.405,115.143,122,122,122,138,138,141,153,153,155,155,155,157,154,154,154,154,153,151,151,141,141,141,126,126,119,119,104,104,100,99,99,99,112.067,99.244,98,101,91,85,85,72,72,70,70.533,72,75.22,74,73,73.415,69.32,66,64,63,63,NA,256,265,269,270,281.246,288.214,278,289,289,289,301,306.333,306.333,301,307,307,307,301,286,292,292,292,277,277,270.481,NA,241,232,232,232,241,223.515,223.537,234,234,230.765,237.348,243,243,243,256,256,253,252,253,245.253,NA,279,278,270,269,265,NA,317,317,317,NA,286,278,279,292,NA,225,225,225,225,NA,122,120.566,127.25,132,122,122,NA,235,222.735,220.338,219.837,218.875,217,224.567,235,235,243,243,243,252,252,252,243,235,235,NA,195,205.543,213.483,218.412,202,NA,279.695,286.11,296.053,291.024,NA,179,179,179,179,179,191.433,201.149,190.529,NA,193,190,189,185,190.927,206,195,196,195,195,200,200,200,212,214.991,214.991,212,229,229,229,231,229.232,212,229,229,229,238,229.588,227,209,209,210,210,210,210,209,206,211.867,200.963,189,190,193,193,193,NA,249,255.904,270.82,274,274,279.404,270,270,261.25,NA,315,315,315,NA,231,226,241,225.549,219,226.532,241,236,231,231,235.875,246.692,255,253,257,257,257,257,260.75,255.154,251.952,241,242,231,231,NA,283,283,283,269.663,263.33,269.061,276,284,290.759,299,299,299,314.78,309,309,300,300,300,288.713,NA,147,157.278,164.638,163.18,162.846,NA,333,347.676,357.15,357.524,345.25,NA,333,333,333,333,NA,328,328,328,NA,180,180,180,NA,122,122,116,NA,103,103,108,116,100.063,97,97,95,94,94,95,96,98,NA,184,184,184,184,NA,246,246,246,246,NA,216,216,216,216,NA,281,281,281,NA,154,154,154,154,154,154,NA,213.857,220,220,220,227.638,221.209,NA,140,139,139,136,134,134,134,581,581,581,593,594,594,594,602,602,615,615,618,618,621,624,626,633.667,642,642,646,646,647,649.909,651,655,655,653.462,653,653,651,650,650,646,646,642,642,629,629,629,624,624,622,617,617,605,604,591,577,570,570,567,566,551.655,549.5,548,548,538.211,533,533,526.492,512,511,511,504,501.261,504,503,501,501,496,496,496,490.333,483,476,476,476,469.222,467.522,465.051,478.043,491,491,503.6,514,514,514,518.375,518,517,517,518,520,534.667,540,545,546,548,552.444,555,556,558,558,562,566,529,529,532,545.636,559,559,559,558.833,557,557,552.444,548,548,546,545,540,540,534.667,520,518,518,516,517,517,517,525,526,561,581,587,587,601.424,608,608,609,610.321,623,630,636,637,637,637.667,640,640,639,635,635,622,622,613.293,601,588,588,584,583,583,578,571,571,570.2,566,562,558,558,557.087,555.762,557,557,558.833,559,559,545.636,532,529,529,526,525,517,517,516.406,516.406,517,515.171,499.762,499.341,502.527,510,510,511,511,509,509,509,509,504,504,506,505,504,512,520.387,535.75,540,540,540,540,556,558,483,490.333,496,496,496,501,501,503,503,504,501.261,504,511,511,512,526.492,533,533,538.211,548,548,548,550,546,546,544,544,555,555,556,557,557,557,557,556,555,550,550,550,543,543,543,542.077,537.12,537,537,528,528,528,526.112,510,510,504,488.022,478,478,469,469,451,445,445,432,432,432,424,419,413,409,410,411,411,410,415,416,419.661,418,418,418,422,424,424,432,432,432,447,449,449,449,451.531,468,468,468,476,476,476,312,312,317,318,322.186,337,337,350,350,355,355,357.057,358,353,353,351.286,349,349,339,339,325.568,330,350,334,334,334,323,323,323,318,318,307,307,297.913,292,280.25,279.89,264,264,263,257,255,255,248,248,248.957,248,245,245,238,221.2,219,212,203.43,189,179,179,173,172,172,173,180,180,197,203.286,206.295,214,224.508,241,242,246,248,263,263,268.29,281,291,291,305,305,307,178,181.65,192.815,201,217.2,221,235.955,242,242,254,270,270,277,277,281,290,290,294,294,295.358,306.138,314.16,322,322,330,349,349,351,351.889,350,348,348,349,353.5,358,358,359,369,369,376.452,371,371,371,371.763,368,368,368,361,361,353,353,353,344,344,340,340,335.738,330,330,326.333,311.065,299.080,296,296,279,277,277,269,254,246,245,244,243,232.714,224,222,220,218.98,211.422,205,205,191.667,185,177,177,168.568,159.097,148,148,136,135,134,134,136,137,144,144,145.818,158.023,168,170,171,NA,91,92,92,91,87,88,372.636,371,371,371,380,381,381,391.727,394,394,399,402,408.571,419,424.5,430,430,430,444,449,449,449,449,449,448.778,447,432,432,432,424,424,422,418,418,418,419.661,416,415,410,411,411,410,409,409.167,409,407.833,405,392,392,382,382,381,381,382,382,383.477,384,383.441,381.958,380.91,379,378,373,360,357,357,344.667,334.625,329,322,321,321,315.69,316,320.762,322.286,323,323,323,334,334,334,350,330,325.568,339,339,349,349,351.286,353,353,358,357.057,355,354.494,354.888,353,353,353,353,353.558,361,361,368,368,368,371.763,371,371,371,372.636),
y=c(366,370,371.143,376.571,379,384.143,385,385,399,399,399,411,421,421.25,423,437,442.333,454,457,467.401,473.78,478.305,493,496.556,513,514,514,525.543,528.727,540,540,543,544,544,550.656,567.2,577,577,577,578,578,581,581,581,573,573,561,561,556,556,555.363,553,550,547.5,531,529,529,524.111,514,508,500,488,481.737,467,467,462,462,462,462,459.043,447,440,430,428,411,409,409,406,406,406,394,394,384,384,370,367,367,360,360,358,358,NA,461,469.25,470.374,462.353,461,461,454,454.643,455.429,456,457,457,456,448.129,460.208,471,471,472.409,474,477,480,490.889,501,501,506,506,506,509,509,509.571,511,511,518,518,518.167,518.5,519,520.396,533.488,548.36,554.702,563,563,574.5,590,603,614,617,629,629,632,635,635,635,638.83,635,635,617,615.167,610,610,605,605,596,589,586,584,574.963,566.187,552.126,545.045,533.417,527,527,527,527,506.34,501,501,501,492,486,486,485.415,480,480,463,460.941,456.114,456,454.094,455,455,455,445.909,445.833,445,NA,459,459,459,459,460.833,460.3,453.462,373,373,376,376,379,387,387,389,389,399.793,395,389,389,394.687,394,394,394,398,398,415,415,415,419,428,428,428,433.634,448.217,460.3,470,470,470,472,473,473,473,472.846,471,471,460.208,448.129,456,457,457,456,455.429,454.643,454,445,445.833,445.909,455,455,455,454.094,456,456.114,466.222,479,479,479,480.5,482,482,479,467.401,457,454,442.333,437,423,421.25,421,410,410,404,404,404,389.556,379,376,375,373,373,373,373,545.623,541,541,534,534,534,545,545,546,546,554,554,554,554,564,564,573,573,581,581,581,579.78,585,585,585,598,608,608,609,609,609,617,635,635,641,642,655.138,664,667,667,674.778,677,677,684.426,703,703,707,709,713,713,723,725,725,723,723,721,718,718,712.525,710.882,707,707,704,704,704,699.172,701,701,702,702,702,703,703,713,713,713,709,698,698,690,676,676,670,670,651,648,648,641,631.476,617,617,607,607,601.091,588,588,578.033,571,569,564,560,553,553,543.836,534,531,NA,577,585.369,593.874,588.006,577,577,263,264,264,274,274,279,279,283,283,289,289,290,301,316,327.476,331,331,332,341,341,345,354.551,359.792,362.122,363,365.966,367,367,370,384,384,394,394,406,406,406,409,409,411,419.13,418,417,412,412,408,406,388.323,387.508,382.783,379.821,384,384,381.818,381,381,392,392,393,394,394,394,393,391,383,382.111,381,381,375,374,368,368,354.551,346.037,341,331,321,324,324,325,333,322.625,308.439,304,304,303,292.935,279.634,266,266,262,262,261,261,261,79,79,78,78,77,76,76,90.389,90.517,84,84,75,75,76,76,77,85.333,93.826,92,92,101,101,103,106,113,113,121,121,121,121,125,126,129,129,137.304,148.773,154.673,168.268,169,180,184,184.375,190,190,190,191.6,197,197,203.478,217.839,223,223,223,223,223,231,231,231,231,229,216,216,216,214.5,213,209.208,211,211,209,209,205.429,197,197,195,176,175,175,160.688,151,151,132,131,131,126,121,119,112,104,88,88,86,86,68,68,68,1114,1123,1123,1141,1141,1146.932,1162,1162,1162,1171,1171,1183.19,1190,1209,1209,1213,1213,1213,1213,1204,1204,1193,1193,1193,1189,1189,1189,1179,1179,1179,1172.609,1158.928,1160,1159,1150,1146,1146,1133.867,1131,1114,1114,1109,1109,1109,1109,NA,609,609,618,627.599,621,621,621,620,620,621,623,630,639.75,654,654,654.289,664.085,667.25,668.945,670,670,676,676,690,698,709,713,713,713,704.459,705.764,704.416,704,704,700.824,699.172,699.588,704.5,703.085,704,704,704,707,707,710.882,712.525,718,718,721,723,723,725,725,724.308,725,725,734,734,740,740,740,744,754.737,768,768,771,771,776,776,778,786.211,802,802,805,820.994,823.917,835,841,841,841,841,846,856,856,856,865,867,867,867,867,866.091,866,866,865.725,865.083,866,866,868,868,865.676,871,871,870.692,869,869,864.766,878.736,882,885,900.564,903.667,915,915,915,922,922,922,925.864,935,935,940,940,943,949,951,952,963.429,968.4,984,984,984,993.706,1005,1005,1016,1016,1016,1024,1044,1055,1044,1044,1041.332,1039.722,1051,1051,1050,1048,1043,1031.462,1028,1028,1027,1020,1003,992,989,989,970,970,969,969,966,966,966,966,963.397,964,964,964,965.818,968,968,958.516,959,959,959,948,944,932,932,914,911.158,896,896,891,891,886,886,886,869,859,859,859,859,859,859,857,857,857,867,874,874,860,860,847,847,844,844,844,841.526,830,821,813,799,807.96,799,786,770.478,769.958,769.419,779,767,754.12,761,756,740,732.639,724.143,725,725,723,720,720,718,718,718,722,722,724.845,724.15,708,708,708,698.933,689.645,687,687,686,680.077,671.353,673,688,688,673,669,669,667,653,653,651,651,642,642,642,645,645,649,649,649,649,647,648,651,666,671.742,662.974,649,648,647,633.8,620,608,608,604,604,604,NA,989,989.6,985.881,978.69,NA,798,800,809,819,827.77,840,848,865.241,873,873,883.973,890.714,895,895,895,911,911,917,931,931,934,934,934,937,946,946,946,961,964,965,965,957,957,957,948,948,944,944,938,938,931,927,925,925,922.2,911.209,912,893,882,881,881,874,874,871,870.2,868,851.098,845,827,821.61,811.885,804,800,797,794,NA,916,930,944,946,960.459,952.857,938,952,952,952,944,954.667,954.667,944,929,929,929,944,931,919,919,919,910,910,909.185,NA,923,911,911,911,923,933.123,933.146,936,936,952.176,956.565,956,956,956,935,935,928,924,915,908.114,NA,933,938,946,944,930,NA,942,942,942,NA,931,938,933,919,NA,921,921,921,921,NA,901,905.779,914.969,912,901,901,NA,874,876.453,876.932,877.707,881.875,895,908.452,901,901,889,889,889,877,877,877,889,874,874,NA,871,888.252,882.793,878.412,862,NA,866.504,874.844,860.758,858.411,NA,860,860,860,860,860,868.548,861.607,856.706,NA,759,780,781,795,801.52,792,806,821,828,842.625,847,847,847,839,856.949,856.949,839,854,854,854,839,827.512,839,826,826,826,816,812.941,812.571,810,810,801,801,801,801,810,792,783.933,778.481,781,780,759,759,759,NA,813,819.277,820.697,821,821,804.787,799,799,795.5,NA,813,813,813,NA,744,754,769,754.515,762,778.947,769,780,784.167,798.4,804.25,811.462,793,789,779,779,779,779,760.25,758.385,758.048,769,757,744,744,NA,776,776,776,773.894,784.45,792.265,794,799,806.373,805,805,805,792.179,789,789,779,779,779,768.654,NA,786,797.012,785.563,771.713,771.086,NA,789,793.892,790.9,790.651,781.65,NA,789,789,789,789,NA,776,776,776,NA,771,771,771,NA,756,761,754,NA,743,743,747,754,747.438,747,747,746,745,743,740,739,739,NA,752,752,752,752,NA,742,742,742,742,NA,738,738,738,738,NA,733,733,733,NA,730,730,730,730,730,730,NA,723.929,727,727,727,718.668,714.739,NA,694,697,697,694,688,688,688,182,182,182,184,184,184,184,193,199,212,212,214,214,216,219,222,237.333,249,249,255,255,259,273.545,276,293,294,304,310,310,316,318,318,323,323,328,328,338,338,338,341,341,342,343,343,344,344,345,345,344,344,342,339,322.862,322,319,319,310.842,301,301,298.559,286,284,284,270,254.478,249,243,232,232,228,228,228,228,224,221,221,221,222.694,222.163,217.839,203.478,197,197,191.6,190,190,190,184.375,184,182,182,184,186,190.889,194,196,195,192,179.556,177,176.667,176,176,175,175,155,155,157,167.428,169,169,172,172.25,175,175,179.556,192,192,195,196,194,194,190.889,186,184,184,180,169,169,169,154,154,97,108.429,111,111,116.939,116,116,117,123.167,135,139,143,144,144,157.333,169,169,171,171,171,169,169,168.488,172,177,177,178,178,178,177,177,177,176.96,175,175,176,176,176.304,176.238,175,175,172.25,172,169,167.428,157,155,155,154,154,169,169,175.538,175.538,169,168.268,154.673,148.773,137.304,129,129,126,125,121,121,121,121,113,113,106,103,101,101,102.677,101.214,100,100,100,100,95,95,224,228,228,228,228,232,232,243,243,249,254.478,270,284,284,286,298.559,301,301,310.842,319,319,319,323,329,329,331.75,347,358,358,360,363,363,363,369,373,376,386,386,386,399,399,399,398.923,398.51,398,398,394,394,394,394.687,389,389,395,399.793,389,389,387,387,379,376,376,373,373,373,373,372,366,356,345,333,323,316,298,296,280.625,269,263,263,255,251,251,241,241,241,233,232,232,232,231.719,223,223,223,221,221,221,166,166,167,168,172.947,182,182,187,187,190,190,195.486,198,216,216,217.286,219,219,226,226,233.387,252,257,272,272,272,279,279,279,283,283,281,281,277.696,274,274,273.932,264,264,263,261,261,261,262,262,263.913,264,263,263,260,251.6,251,247,241.547,239,231,231,227,225,224,209,202,202,193,195.286,195.486,196,203.706,188,187,185,185,187,187,187.962,176,168,168,165,165,165,17,23.845,36.323,41,50,50,50.748,48,48,46,37,37,35,35,37,50,50,56,56,69.582,81.080,85.76,88,88,90,88,88,88,88.889,104,112,119,121,126,131,131,132,151,151,160.688,175,175,176,177.61,182,182,182,188,188,183,183,183,176,176,173,173,168.311,162,162,156,144.548,145.88,147,147,149,149,149,149,148,146,145,142,139,127,127,125,116,107.331,94.963,89,89,78.333,75,60,60,49.459,42.774,40,40,34,31,26,24,21,21,23,23,23.182,24.402,13,11,11,NA,10,11,16,16,15,8,170.706,175,175,176,195,197,197,205.429,209,209,211,211,209.208,213,214.5,216,216,216,229,231,231,231,231,231,232.111,233,241,241,241,251,251,255,263,263,269,280.625,296,298,316,323,333,345,356,356.417,357,358,358,360,360,367,367,368,368,367,367,365.966,363,362.122,359.792,354.551,345,341,341,332,331,331,327.476,316,301,290,289,289,286.549,285,281.19,279.571,279,279,279,272,272,272,257,252,233.387,226,226,219,219,217.286,216,216,198,195.486,190,189.697,187.596,185,185,184,184,183.349,188,188,182,182,182,177.61,176,175,175,170.706)
    );

};

map.England.Wales <- function () {
    data.frame(
z=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14),
x=c(413,417,417,419,419,420.286,420,420,411,411,411,401,391,390.75,389,385,385,375,376,387.094,384.843,379.864,379,378.605,385,384,384,369.793,367.545,376,376,378,378,378,372.77,366.98,366,366,366,356,356,348,348,348,333,333,319,319,312,312,311.575,310,309,308.167,299,298,298,297.111,294,297,303,307,311.474,317,317,321,321,321,321,338.742,331,330,330,331,337,339,339,342,342,342,356,356,366,366,379,382,382,392,392,405,409.8,NA,340,331.75,333.324,340.676,340,340,478,478.643,479.429,480,482,486,488,497.839,513.943,511,511,514.523,515,515,513.5,512,503.444,498,498,495,495,495,492,492,491.429,490,490,478,478,477.5,476.5,475,470.462,452.695,443.4,441.638,441,441,435.25,430.6,428,426,426,423,423,422,418,418,418,409.383,403,388.292,387,387,381,381,371,371,360,359,360,363,371.284,367.334,372.256,378.591,380.917,380,380,380,380,388.854,384,384,384,382,381,381,386.268,398,398,410,410.824,416.857,418,438.008,440,441,441,452.818,454.333,471,NA,517,517,517,517,515.833,515.3,518.231,432,432,445,445,451,469,469,478,478,488.022,504,510,510,526.112,528,528,528,537,537,541,541,541,540,534,534,534,529.39,520.478,515.3,525,525,525,523,519,519,516,515.615,511,511,513.943,497.839,488,486,482,480,479.429,478.643,478,471,454.333,452.818,441,441,440,438.008,418,416.857,404.222,394,394,394,389,384,382,383,387.094,376,375,385,385,389,390.75,391,402,402,409,409,409,421.639,419,419,420,424,424,424,432,403,413,413,413,413,398,395,395,379,383,384,384,386,386,NA,348,348,348,351,351,347,343.714,263,264,264,280,292,300,300,308,308,321,321,322,329,334.625,344.667,357,357,360,373,378,379,380.91,381.958,383.441,384,383.477,382,382,379,366,366,356,356,342,342,342,339,339,337,334.13,333,332,329,329,327,327,318.161,316.607,303.217,292.554,275,275,267,264,263,247,247,245,242,242,237,234,229,222,221.556,221,221,226,227,233,233,240.565,234.556,227,217,211,229,229,231,245,255.375,256.951,256,256,256,258.516,256.416,250,250,248,248,255,255,257,382,382,392,392,396,402,402,416.389,418.828,430,430,430,449,450,455,455,457,463.667,480.652,484,486,504,504,505,506,504,504,509,509,509,509,511,511,510,510,502.527,499.341,499.762,515.171,517,517,516,518,518.375,514,514,514,503.6,491,491,478.043,465.051,468,468,468,468,468,452.889,449,449,449,444,444,430,430,430,424.5,419,408.571,402,399,394,394,391.727,381,381,380,371,371,371,376.452,369,369,359,358,358,353.5,349,348,348,350,352,352,353,353,367,367,367,581,581,581,593,594,594,594,602,602,615,615,618,618,621,624,626,633.667,642,642,646,646,647,649.909,651,655,655,653.462,653,653,651,650,650,646,646,642,642,629,629,629,624,624,622,617,617,605,604,591,577,570,570,570,567,566,551.655,549.5,548,548,538.211,533,533,526.492,512,511,511,504,501.261,504,503,501,501,496,496,496,490.333,483,476,476,476,469.222,467.522,465.051,478.043,491,491,503.6,514,514,514,518.375,518,517,517,518,520,534.667,540,545,546,548,552.444,555,556,558,558,562,566,529,529,532,545.636,559,559,559,558.833,557,557,552.444,548,548,546,545,540,540,534.667,520,518,518,516,517,517,517,525,526,561,581,587,587,601.424,608,608,609,610.321,623,623,630,633,633,636,637,637,637.667,640,640,639,635,635,622,622,613.293,601,588,588,584,583,583,578,571,571,570.2,566,562,558,558,557.087,555.762,557,557,559,559,545.636,532,529,529,526,525,517,517,516.406,516.406,517,517,515.171,499.762,499.341,502.527,510,510,511,511,509,509,509,509,504,504,506,505,504,512,520.387,535.75,540,540,540,556,558,483,490.333,496,496,496,501,501,503,503,504,501.261,504,511,511,512,526.492,533,533,538.211,548,548,548,550,546,546,544,544,555,555,556,557,557,557,557,556,555,550,550,550,543,543,543,542.077,537.12,537,537,528,528,528,526.112,510,510,504,488.022,478,478,469,469,451,445,445,432,432,432,424,419,413,409,410,411,411,410,415,416,419.661,418,418,418,422,424,424,432,432,432,447,449,449,449,451.531,468,468,468,476,476,476,312,312,317,318,322.186,337,337,350,350,355,355,357.057,358,353,353,353,353,351.286,349,339,339,325.568,330,350,334,334,334,323,323,323,318,318,307,307,297.913,292,280.25,279.89,264,264,263,257,255,255,248,248,248.957,248,245,245,238,221.2,219,212,203.43,189,179,179,173,172,172,173,180,180,197,203.286,206.295,214,224.508,241,242,246,248,263,263,268.29,281,291,291,305,305,307,178,181.65,192.815,201,217.2,221,235.955,242,254,270,270,277,277,281,290,290,294,294,295.358,306.138,314.16,322,322,330,349,349,351,351.889,350,348,348,349,353.5,358,358,359,369,369,376.452,371,371,371,371.763,368,368,368,361,361,353,353,353,344,344,340,340,335.738,330,330,326.333,311.065,299.080,296,296,279,277,277,269,254,246,245,244,243,232.714,224,222,220,218.98,211.422,205,205,205,191.667,185,177,177,168.568,159.097,148,148,136,135,134,134,136,137,144,144,145.818,158.023,168,170,171,NA,91,92,92,91,87,88,381,381,382,NA,382,382,382.951,NA,372.636,371,371,371,380,381,381,391.727,394,394,399,402,408.571,419,424.5,430,430,430,444,444,449,449,449,449,449,448.778,447,432,432,432,424,424,422,418,418,418,419.661,416,415,410,411,411,410,409,409.167,409,407.833,405,392,392,383.477,384,383.441,381.958,380.91,379,378,373,360,357,357,344.667,334.625,329,322,321,321,315.69,316,320.762,322.286,323,323,323,334,334,334,350,330,325.568,339,339,349,353,353,353,353,358,357.057,355,355,354.494,354.888,353,353,353,353,353.558,361,361,368,368,368,371.763,371,371,371,372.636),
y=c(366,370,371.143,376.571,379,384.143,385,385,399,399,399,411,421,421.25,423,437,442.333,454,457,467.401,473.78,478.305,493,496.556,513,514,514,525.543,528.727,540,540,543,544,544,550.656,567.2,577,577,577,578,578,581,581,581,573,573,561,561,556,556,555.363,553,550,547.5,531,529,529,524.111,514,508,500,488,481.737,467,467,462,462,462,462,459.043,447,440,430,428,411,409,409,406,406,406,394,394,384,384,370,367,367,360,360,358,358,NA,461,469.25,470.374,462.353,461,461,454,454.643,455.429,456,457,457,456,448.129,460.208,471,471,472.409,474,474,477,480,490.889,501,501,506,506,506,509,509,509.571,511,511,518,518,518.167,518.5,519,520.396,533.488,548.36,554.702,563,563,574.5,590,603,614,617,629,629,632,635,635,635,638.83,635,629.809,628,626,610,610,605,605,596,589,586,584,574.963,566.187,552.126,545.045,533.417,527,527,527,527,506.34,501,501,501,492,486,486,485.415,480,480,463,460.941,456.114,456,454.094,455,455,455,445.909,445.833,445,NA,459,459,459,459,460.833,460.3,453.462,373,373,376,376,379,387,387,389,389,399.793,395,389,389,394.687,394,394,394,398,398,415,415,415,419,428,428,428,433.634,448.217,460.3,470,470,470,472,473,473,473,472.846,471,471,460.208,448.129,456,457,457,456,455.429,454.643,454,445,445.833,445.909,455,455,455,454.094,456,456.114,466.222,479,479,479,480.5,482,482,479,467.401,457,454,442.333,437,423,421.25,421,410,410,404,404,404,389.556,379,376,375,373,373,373,373,635,641,641,642,642,656,653,653,638,631,630,630,629,629,NA,581,581,581,579.875,582,582,578.714,263,264,264,274,274,279,279,283,283,289,289,290,301,316,327.476,331,331,332,341,341,345,354.551,359.792,362.122,363,365.966,367,367,370,384,384,394,394,406,406,406,409,409,411,419.13,418,417,412,412,408,406,388.323,387.508,382.783,379.821,384,384,381.818,381,381,392,392,393,394,394,394,393,391,383,382.111,381,381,375,374,368,368,354.551,346.037,341,331,321,324,324,325,333,322.625,308.439,304,304,303,292.935,279.634,266,266,262,262,261,261,261,79,79,78,78,77,76,76,90.389,90.517,84,84,84,75,75,76,76,77,85.333,93.826,92,92,101,101,103,106,113,113,121,121,121,121,125,126,129,129,137.304,148.773,154.673,168.268,169,169,180,184,184.375,190,190,190,191.6,197,197,203.478,217.839,223,223,223,223,223,231,231,231,231,229,229,216,216,216,214.5,213,209.208,211,211,209,209,205.429,197,197,195,176,175,175,160.688,151,151,132,131,131,126,121,119,112,104,88,88,86,86,68,68,68,182,182,182,184,184,184,184,193,199,212,212,214,214,216,219,222,237.333,249,249,255,255,259,273.545,276,293,294,304,310,310,316,318,318,323,323,328,328,338,338,338,341,341,342,343,343,344,344,345,345,344,344,344,342,339,322.862,322,319,319,310.842,301,301,298.559,286,284,284,270,254.478,249,243,232,232,228,228,228,228,224,221,221,221,222.694,222.163,217.839,203.478,197,197,191.6,190,190,190,184.375,184,182,182,184,186,190.889,194,196,195,192,179.556,177,176.667,176,176,175,175,155,155,157,167.428,169,169,172,172.25,175,175,179.556,192,192,195,196,194,194,190.889,186,184,184,180,169,169,169,154,154,97,108.429,111,111,116.939,116,116,117,123.167,135,135,139,141,141,143,144,144,157.333,169,169,171,171,171,169,169,168.488,172,177,177,178,178,178,177,177,177,176.96,175,175,176,176,176.304,176.238,175,175,172,169,167.428,157,155,155,154,154,169,169,175.538,175.538,169,169,168.268,154.673,148.773,137.304,129,129,126,125,121,121,121,121,113,113,106,103,101,101,102.677,101.214,100,100,100,95,95,224,228,228,228,228,232,232,243,243,249,254.478,270,284,284,286,298.559,301,301,310.842,319,319,319,323,329,329,331.75,347,358,358,360,363,363,363,369,373,376,386,386,386,399,399,399,398.923,398.51,398,398,394,394,394,394.687,389,389,395,399.793,389,389,387,387,379,376,376,373,373,373,373,372,366,356,345,333,323,316,298,296,280.625,269,263,263,255,251,251,241,241,241,233,232,232,232,231.719,223,223,223,221,221,221,166,166,167,168,172.947,182,182,187,187,190,190,195.486,198,216,216,216,216,217.286,219,226,226,233.387,252,257,272,272,272,279,279,279,283,283,281,281,277.696,274,274,273.932,264,264,263,261,261,261,262,262,263.913,264,263,263,260,251.6,251,247,241.547,239,231,231,227,225,224,209,202,202,193,195.286,195.486,196,203.706,188,187,185,185,187,187,187.962,176,168,168,165,165,165,17,23.845,36.323,41,50,50,50.748,48,46,37,37,35,35,37,50,50,56,56,69.582,81.080,85.76,88,88,90,88,88,88,88.889,104,112,119,121,126,131,131,132,151,151,160.688,175,175,176,177.61,182,182,182,188,188,183,183,183,176,176,173,173,168.311,162,162,156,144.548,145.88,147,147,149,149,149,149,148,146,145,142,139,127,127,125,116,107.331,94.963,89,89,89,78.333,75,60,60,49.459,42.774,40,40,34,31,26,24,21,21,23,23,23.182,24.402,13,11,11,NA,10,11,16,16,15,8,368,368,367,NA,367,367,366.334,NA,170.706,175,175,176,195,197,197,205.429,209,209,211,211,209.208,213,214.5,216,216,216,229,229,231,231,231,231,231,232.111,233,241,241,241,251,251,255,263,263,269,280.625,296,298,316,323,333,345,356,356.417,357,358,358,360,360,365.966,363,362.122,359.792,354.551,345,341,341,332,331,331,327.476,316,301,290,289,289,286.549,285,281.19,279.571,279,279,279,272,272,272,257,252,233.387,226,226,219,216,216,216,216,198,195.486,190,190,189.697,187.596,185,185,184,184,183.349,188,188,182,182,182,177.61,176,175,175,170.706)
    );

};

map.England <- function () {
    data.frame(
z=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14),
x=c(413,417,417,419,419,420.286,420,420,411,411,411,401,391,390.75,389,385,385,375,376,387.094,384.843,379.864,379,378.605,385,384,384,369.793,367.545,376,376,378,378,378,372.77,366.98,366,366,366,356,356,348,348,348,333,333,319,319,312,312,311.575,310,309,308.167,299,298,298,297.111,294,297,303,307,311.474,317,317,321,321,321,321,338.742,331,330,330,331,337,339,339,342,342,342,356,356,366,366,379,382,382,392,392,405,409.8,NA,340,331.75,333.324,340.676,340,340,478,478.643,479.429,480,482,486,488,497.839,513.943,511,511,514.523,515,515,513.5,512,503.444,498,498,495,495,495,492,492,491.429,490,490,478,478,477.5,476.5,475,470.462,452.695,443.4,441.638,441,441,435.25,430.6,428,426,426,423,423,422,418,418,418,409.383,403,388.292,387,387,381,381,371,371,360,359,360,363,371.284,367.334,372.256,378.591,380.917,380,380,380,380,388.854,384,384,384,382,381,381,386.268,398,398,410,410.824,416.857,418,438.008,440,441,441,452.818,454.333,471,NA,517,517,517,517,515.833,515.3,518.231,432,432,445,445,451,469,469,478,478,488.022,504,510,510,526.112,528,528,528,537,537,541,541,541,540,534,534,534,529.39,520.478,515.3,525,525,525,523,519,519,516,515.615,511,511,513.943,497.839,488,486,482,480,479.429,478.643,478,471,454.333,452.818,441,441,440,438.008,418,416.857,404.222,394,394,394,389,384,382,383,387.094,376,375,385,385,389,390.75,391,402,402,409,409,409,421.639,419,419,420,424,424,424,432,403,413,413,413,413,398,395,395,379,383,384,384,386,386,NA,348,348,348,351,351,347,343.714,334.625,344.667,357,357,357,360,373,378,379,381.958,384,384,383.477,382,382,379,366,366,356,356,342,342,342,339,339,337,334.13,333,332,332,329,327,327,318,318,329,332.623,334,334,341.269,333,333,326,326,323.5,323,322,321,321,329.68,326,326,329,382,382,392,392,396,402,402,416.389,418.828,430,430,430,449,450,455,455,457,463.667,480.652,484,486,504,504,505,506,504,504,509,509,509,509,511,511,510,510,502.527,499.341,499.762,515.171,517,517,516,518,518.375,514,514,514,503.6,491,491,478.043,465.051,468,468,468,468,468,452.889,449,449,449,444,444,430,430,430,424.5,419,408.571,402,399,394,394,391.727,381,381,380,371,371,371,376.452,369,369,359,358,358,353.5,349,348,348,350,352,352,353,353,367,367,367,581,581,581,593,594,594,594,602,602,615,615,618,618,621,624,626,633.667,642,642,646,646,647,649.909,651,655,655,653.462,653,653,651,650,650,646,646,642,642,629,629,629,624,624,622,617,617,605,604,591,577,570,570,570,567,566,551.655,549.5,548,548,538.211,533,533,526.492,512,511,511,504,501.261,504,503,501,501,496,496,496,490.333,483,476,476,476,469.222,467.522,465.051,478.043,491,491,503.6,514,514,514,518.375,518,517,517,518,520,534.667,540,545,546,548,552.444,555,556,558,558,562,566,529,529,532,545.636,559,559,559,558.833,557,557,552.444,548,548,546,545,540,540,534.667,520,518,518,516,517,517,517,525,526,561,581,587,587,601.424,608,608,609,610.321,623,623,630,633,633,636,637,637,637.667,640,640,639,635,635,622,622,613.293,601,588,588,584,583,583,578,571,571,570.2,566,562,558,558,557.087,555.762,557,557,559,559,545.636,532,529,529,526,525,517,517,516.406,516.406,517,517,515.171,499.762,499.341,502.527,510,510,511,511,509,509,509,509,504,504,506,505,504,512,520.387,535.75,540,540,540,556,558,483,490.333,496,496,496,501,501,503,503,504,501.261,504,511,511,512,526.492,533,533,538.211,548,548,548,550,546,546,544,544,555,555,556,557,557,557,557,556,555,550,550,550,543,543,543,542.077,537.12,537,537,528,528,528,526.112,510,510,504,488.022,478,478,469,469,451,445,445,432,432,432,424,419,413,409,410,411,411,410,415,416,419.661,418,418,418,422,424,424,432,432,432,447,449,449,449,451.531,468,468,468,476,476,476,330,350,331,331,323,318,317,321,326.523,324.214,323,325,NA,358,353,349,349,349,335,347.379,353,353,354,355,178,181.65,192.815,201,217.2,221,235.955,242,254,270,270,277,277,281,290,290,294,294,295.358,306.138,314.16,322,322,330,349,349,351,351.889,350,348,348,349,353.5,358,358,359,369,369,376.452,371,371,371,371.763,368,368,368,361,361,353,353,353,344,344,340,340,335.738,330,330,326.333,311.065,299.080,296,296,279,277,277,269,254,246,245,244,243,232.714,224,222,220,218.98,211.422,205,205,205,191.667,185,177,177,168.568,159.097,148,148,136,135,134,134,136,137,144,144,145.818,158.023,168,170,171,NA,91,92,92,91,87,88,372.636,371,371,371,380,381,381,391.727,394,394,399,402,408.571,419,424.5,430,430,430,444,444,449,449,449,449,449,448.778,447,432,432,432,424,424,422,418,418,418,419.661,416,415,410,411,411,410,409,409.167,409,407.833,405,392,392,382,382,381,381,382,382,383.477,384,384,381.958,379,378,373,360,357,357,357,344.667,334.625,329,326,326,327.915,323,323,317,320,322.286,323,331,350,330,325,324.538,322,322,323,327,333,333,339.29,335,349,349,349,353,358,355,354.437,354.888,353,353,353,353,353.558,361,361,368,368,368,371.763,371,371,371,372.636,NA,353,351.937,352,353),
y=c(366,370,371.143,376.571,379,384.143,385,385,399,399,399,411,421,421.25,423,437,442.333,454,457,467.401,473.78,478.305,493,496.556,513,514,514,525.543,528.727,540,540,543,544,544,550.656,567.2,577,577,577,578,578,581,581,581,573,573,561,561,556,556,555.363,553,550,547.5,531,529,529,524.111,514,508,500,488,481.737,467,467,462,462,462,462,459.043,447,440,430,428,411,409,409,406,406,406,394,394,384,384,370,367,367,360,360,358,358,NA,461,469.25,470.374,462.353,461,461,454,454.643,455.429,456,457,457,456,448.129,460.208,471,471,472.409,474,474,477,480,490.889,501,501,506,506,506,509,509,509.571,511,511,518,518,518.167,518.5,519,520.396,533.488,548.36,554.702,563,563,574.5,590,603,614,617,629,629,632,635,635,635,638.83,635,629.809,628,626,610,610,605,605,596,589,586,584,574.963,566.187,552.126,545.045,533.417,527,527,527,527,506.34,501,501,501,492,486,486,485.415,480,480,463,460.941,456.114,456,454.094,455,455,455,445.909,445.833,445,NA,459,459,459,459,460.833,460.3,453.462,373,373,376,376,379,387,387,389,389,399.793,395,389,389,394.687,394,394,394,398,398,415,415,415,419,428,428,428,433.634,448.217,460.3,470,470,470,472,473,473,473,472.846,471,471,460.208,448.129,456,457,457,456,455.429,454.643,454,445,445.833,445.909,455,455,455,454.094,456,456.114,466.222,479,479,479,480.5,482,482,479,467.401,457,454,442.333,437,423,421.25,421,410,410,404,404,404,389.556,379,376,375,373,373,373,373,635,641,641,642,642,656,653,653,638,631,630,630,629,629,NA,581,581,581,579.875,582,582,578.714,316,327.476,331,331,331,332,341,341,345,359.792,363,363,365.966,367,367,370,384,384,394,394,406,406,406,409,409,411,419.13,418,417,417,412,408,406,388,388,374,369.571,362,362,348.269,340,340,337,337,332,331,328,324,323,311.427,301,301,301,79,79,78,78,77,76,76,90.389,90.517,84,84,84,75,75,76,76,77,85.333,93.826,92,92,101,101,103,106,113,113,121,121,121,121,125,126,129,129,137.304,148.773,154.673,168.268,169,169,180,184,184.375,190,190,190,191.6,197,197,203.478,217.839,223,223,223,223,223,231,231,231,231,229,229,216,216,216,214.5,213,209.208,211,211,209,209,205.429,197,197,195,176,175,175,160.688,151,151,132,131,131,126,121,119,112,104,88,88,86,86,68,68,68,182,182,182,184,184,184,184,193,199,212,212,214,214,216,219,222,237.333,249,249,255,255,259,273.545,276,293,294,304,310,310,316,318,318,323,323,328,328,338,338,338,341,341,342,343,343,344,344,345,345,344,344,344,342,339,322.862,322,319,319,310.842,301,301,298.559,286,284,284,270,254.478,249,243,232,232,228,228,228,228,224,221,221,221,222.694,222.163,217.839,203.478,197,197,191.6,190,190,190,184.375,184,182,182,184,186,190.889,194,196,195,192,179.556,177,176.667,176,176,175,175,155,155,157,167.428,169,169,172,172.25,175,175,179.556,192,192,195,196,194,194,190.889,186,184,184,180,169,169,169,154,154,97,108.429,111,111,116.939,116,116,117,123.167,135,135,139,141,141,143,144,144,157.333,169,169,171,171,171,169,169,168.488,172,177,177,178,178,178,177,177,177,176.96,175,175,176,176,176.304,176.238,175,175,172,169,167.428,157,155,155,154,154,169,169,175.538,175.538,169,169,168.268,154.673,148.773,137.304,129,129,126,125,121,121,121,121,113,113,106,103,101,101,102.677,101.214,100,100,100,95,95,224,228,228,228,228,232,232,243,243,249,254.478,270,284,284,286,298.559,301,301,310.842,319,319,319,323,329,329,331.75,347,358,358,360,363,363,363,369,373,376,386,386,386,399,399,399,398.923,398.51,398,398,394,394,394,394.687,389,389,395,399.793,389,389,387,387,379,376,376,373,373,373,373,372,366,356,345,333,323,316,298,296,280.625,269,263,263,255,251,251,241,241,241,233,232,232,232,231.719,223,223,223,221,221,221,252,257,273,273,279,283,281,277,269.82,254.429,252,251,NA,198,216,219,219,219,224,216.926,201,194,190,190,17,23.845,36.323,41,50,50,50.748,48,46,37,37,35,35,37,50,50,56,56,69.582,81.080,85.76,88,88,90,88,88,88,88.889,104,112,119,121,126,131,131,132,151,151,160.688,175,175,176,177.61,182,182,182,188,188,183,183,183,176,176,173,173,168.311,162,162,156,144.548,145.88,147,147,149,149,149,149,148,146,145,142,139,127,127,125,116,107.331,94.963,89,89,89,78.333,75,60,60,49.459,42.774,40,40,34,31,26,24,21,21,23,23,23.182,24.402,13,11,11,NA,10,11,16,16,15,8,170.706,175,175,176,195,197,197,205.429,209,209,211,211,209.208,213,214.5,216,216,216,229,229,231,231,231,231,231,232.111,233,241,241,241,251,251,255,263,263,269,280.625,296,298,316,323,333,345,356,356.417,357,358,358,360,360,367,367,368,368,367,367,365.966,363,363,359.792,345,341,341,332,331,331,331,327.476,316,301,301,301,306.426,298,294.429,285,282,279.571,279,273,257,252,251,251.231,248,248,241,231,223,223,221.548,224,219,219,219,216,198,190,190,187.596,185,185,184,184,183.349,188,188,182,182,182,177.61,176,175,175,170.706,NA,201,204.013,203,197.667)
    );

};

map.Scotland <- function () {
    data.frame(
z=c(4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7),
x=c(228.537,234,234,245,245,245,263,269,277,277,293.889,297,297,297,297,317,328,328,332,332,343.73,352,352,352,359,370,370,376,376,376,385,385,384,383,383,387.8,393,396,396,394,392,392,374.5,372,372,359.933,357,357,362,363,358,358,348,344,342,333,333,327.4,319,319,316.653,312,301,301,301,301,294,294,294,278.711,265,265,260,260,260,251,251,238,238,238,234,236,236,236,220,220,218,218,217,217,217,222,229.619,226,226,220,220,218.182,210,210,204.393,198,197,196,197,199,199,206.049,209,213,NA,250,239.538,248.651,254.127,250,250,440,443,443,450,450,448.023,456,456,456,468,468,455.81,462,462,463,463,464,461,453,453,446,446,446,436,436,436,423,423,423,428.858,420.217,417,417,419,422,422,436,436,437,437,438,438,438,440,NA,458,458,465.5,458,NA,173,173,175,178.031,195,195,195,203,203,204,205,205,202.75,217,217,217.173,217.689,216.25,217.944,218,218,220,220,236,236,236,234,238,238,238,249.103,250.709,254.751,256,256,266.323,278.711,280.029,288.625,291.102,294,294,294,301,301,312,316.653,319,319,327.4,333,333,342,344,345.385,347,347,357,357,364,364,364,368,372.474,381,381,383,383,386,386,387,388.895,396,396,396,397,399.525,401.417,409,413,413,413,413,413,409,409,409,404,400,396,396,392,382,381,381,376.325,365.417,359,359,349,346,335.93,323,323,321,310,310,304.072,289.28,292,293,288.136,290.722,303,303,303,311,311,311,314.542,327,327,332,332,334,337,338,338,336.095,337.2,345,345,345,347.647,358,358,367,367,367,367,373,376,367,367,362.807,360.278,349,349,344,342,344,334,325,325,324,323,323,328.5,327,327,309,309,302,302,287,282,282,282,267.25,257,257,257,243.364,239,235,220.774,219,219,219,216,214,201,201,196,197.421,187,187,180,180,174,174,174,173,173,173,173,173,173,173,161,161,161,149,144,141,122,122,112,112,116,116,116,125.276,132,140,145,140,148.96,156,147,162.522,162.244,152.539,142,143,137.48,122,122,122,122,135,141.229,134.857,131,128,127,130,130,138,138,138,153,153,161.534,162.55,173,173,173,176.238,172.817,164,164,163,159.615,146.529,142,134,134,141,123,123,122,116,116,116,116,129,129,129,140,140,144,144,144,144,164,164,146,152,155.445,170.59,165,164,164,165.76,163,166,166,172,172,172,NA,328,331,340.297,334.065,NA,69,71,79,79,77.356,83,86,90.31,96,96,105.405,115.143,122,122,122,138,138,141,153,153,155,155,155,157,154,154,154,154,153,151,151,141,141,141,126,126,119,119,104,104,100,99,99,99,112.067,99.244,98,101,91,85,85,72,72,70,70.533,72,75.22,74,73,73.415,69.32,66,64,63,63,NA,256,265,269,270,281.246,288.214,278,289,289,289,301,306.333,306.333,301,307,307,307,301,286,292,292,292,277,277,270.481,NA,241,232,232,232,241,223.515,223.537,234,234,230.765,237.348,243,243,243,256,256,253,252,253,245.253,NA,279,278,270,269,265,NA,317,317,317,NA,286,278,279,292,NA,225,225,225,225,NA,122,120.566,127.25,132,122,122,NA,235,222.735,220.338,219.837,218.875,217,224.567,235,235,243,243,243,252,252,252,243,235,235,NA,195,205.543,213.483,218.412,202,NA,279.695,286.11,296.053,291.024,NA,179,179,179,179,179,191.433,201.149,190.529,NA,193,190,189,185,190.927,206,195,196,195,195,200,200,200,212,214.991,214.991,212,229,229,229,231,229.232,212,229,229,229,238,229.588,227,209,209,210,210,210,210,209,206,211.867,200.963,189,190,193,193,193,NA,249,255.904,270.82,274,274,279.404,270,270,261.25,NA,315,315,315,NA,231,226,241,225.549,219,226.532,241,236,231,231,235.875,246.692,255,253,257,257,257,257,260.75,255.154,251.952,241,242,231,231,NA,283,283,283,269.663,263.33,269.061,276,284,290.759,299,299,299,314.78,309,309,300,300,300,288.713,NA,147,157.278,164.638,163.18,162.846,NA,333,347.676,357.15,357.524,345.25,NA,333,333,333,333,NA,328,328,328,328,NA,180,180,180,NA,122,122,116,NA,103,103,108,116,100.063,97,97,95,94,94,95,96,98,NA,184,184,184,184,NA,246,246,246,246,NA,216,216,216,216,NA,281,281,281,NA,154,154,154,154,154,154,NA,213.857,220,220,220,227.638,221.209,NA,140,139,139,136,134,134,134),
y=c(545.623,541,541,534,534,534,545,545,546,546,554,554,554,554,554,564,564,564,566,566,578.568,585,585,585,598,608,608,609,609,609,617,617,626,629,629,644.2,652,657,660,664,667,667,674.778,677,677,684.426,703,703,707,709,713,713,723,725,725,723,723,721,718,718,712.525,710.882,707,707,707,707,704,704,704,699.172,701,701,702,702,702,703,703,713,713,713,709,698,698,690,676,676,670,670,651,648,648,641,631.476,617,617,607,607,601.091,588,588,578.033,571,569,564,560,553,553,543.836,534,531,NA,577,585.369,593.874,588.006,577,577,1114,1123,1123,1141,1141,1146.932,1162,1162,1162,1171,1171,1183.19,1190,1190,1209,1209,1213,1213,1204,1204,1193,1193,1193,1189,1189,1189,1179,1179,1179,1172.609,1158.928,1160,1159,1150,1146,1146,1133.867,1131,1114,1114,1109,1109,1109,1109,NA,1166,1166,1169.75,1166,NA,609,609,618,627.599,621,621,621,620,620,621,623,630,639.75,654,654,654.289,664.085,667.25,668.945,670,670,676,676,690,698,698,709,713,713,713,704.459,705.764,704.416,704,704,700.824,699.172,699.588,704.5,703.085,704,704,704,707,707,710.882,712.525,718,718,721,723,723,725,725,724.308,725,725,734,734,740,740,740,744,754.737,768,768,771,771,776,776,778,786.211,802,802,802,805,820.994,823.917,835,841,841,841,841,846,856,856,856,865,867,867,867,867,866.091,866,866,865.725,865.083,866,866,868,868,865.676,871,871,870.692,869,869,864.766,878.736,882,885,900.564,903.667,915,915,915,922,922,922,925.864,935,935,940,940,943,949,951,952,963.429,968.4,984,984,984,993.706,1005,1005,1016,1016,1016,1024,1044,1055,1044,1044,1041.332,1039.722,1051,1051,1050,1048,1043,1031.462,1028,1028,1027,1020,1003,992,989,989,970,970,969,969,966,966,966,966,963.397,964,964,964,965.818,968,968,958.516,959,959,959,948,944,932,932,914,911.158,896,896,891,891,886,886,886,869,859,859,859,859,859,859,857,857,857,867,874,874,860,860,847,847,844,844,844,841.526,830,821,813,799,807.96,799,786,770.478,769.958,769.419,779,767,754.12,761,757,757,756,740,732.639,724.143,725,725,723,720,720,718,718,718,722,722,724.845,724.15,708,708,708,698.933,689.645,687,687,686,680.077,671.353,673,688,688,673,669,669,667,653,653,651,651,642,642,642,645,645,649,649,649,649,647,648,651,666,671.742,662.974,649,648,647,633.8,620,608,608,604,604,604,NA,989,989.6,985.881,978.69,NA,798,800,809,819,827.77,840,848,865.241,873,873,883.973,890.714,895,895,895,911,911,917,931,931,934,934,934,937,946,946,946,961,964,965,965,957,957,957,948,948,944,944,938,938,931,927,925,925,922.2,911.209,912,893,882,881,881,874,874,871,870.2,868,851.098,845,827,821.61,811.885,804,800,797,794,NA,916,930,944,946,960.459,952.857,938,952,952,952,944,954.667,954.667,944,929,929,929,944,931,919,919,919,910,910,909.185,NA,923,911,911,911,923,933.123,933.146,936,936,952.176,956.565,956,956,956,935,935,928,924,915,908.114,NA,933,938,946,944,930,NA,942,942,942,NA,931,938,933,919,NA,921,921,921,921,NA,901,905.779,914.969,912,901,901,NA,874,876.453,876.932,877.707,881.875,895,908.452,901,901,889,889,889,877,877,877,889,874,874,NA,871,888.252,882.793,878.412,862,NA,866.504,874.844,860.758,858.411,NA,860,860,860,860,860,868.548,861.607,856.706,NA,759,780,781,795,801.52,792,806,821,828,842.625,847,847,847,839,856.949,856.949,839,854,854,854,839,827.512,839,826,826,826,816,812.941,812.571,810,810,801,801,801,801,810,792,783.933,778.481,781,780,759,759,759,NA,813,819.277,820.697,821,821,804.787,799,799,795.5,NA,813,813,813,NA,744,754,769,754.515,762,778.947,769,780,784.167,798.4,804.25,811.462,793,789,779,779,779,779,760.25,758.385,758.048,769,757,744,744,NA,776,776,776,773.894,784.45,792.265,794,799,806.374,805,805,805,792.179,789,789,779,779,779,768.654,NA,786,797.012,785.563,771.713,771.086,NA,789,793.892,790.9,790.651,781.65,NA,789,789,789,789,NA,776,776,776,776,NA,771,771,771,NA,756,761,754,NA,743,743,747,754,747.438,747,747,746,745,743,740,739,739,NA,752,752,752,752,NA,742,742,742,742,NA,738,738,738,738,NA,733,733,733,NA,730,730,730,730,730,730,NA,723.929,727,727,727,718.668,714.739,NA,694,697,697,694,688,688,688)
    );

};

map.Wales <- function () {
    data.frame(
z=c(5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14),
x=c(263,264,264,264,280,292,300,300,300,308,308,308,321,321,322,327,330,330,330,330,331,330,330,330,328.645,337.75,346,346,351,350,350,340.704,338,338,336,334,332,332,323.333,312,312,310,304,304,292.554,275,275,275,267,264,264,264,263,247,247,245,242,242,242,237,234,229,229,222,221.556,221,221,226,227,227,227,233,233,233,240.565,234.556,227,217,211,229,229,231,245,255.375,256.951,256,256,256,258.516,256.416,250,250,248,248,255,255,257,312,312,317,318,322.186,337,337,350,350,354,354,354,353,353,353,353,353,353,353,353,343.5,339,339,325,325,333,334,334,334,320.765,317,317,314,314,307,307,297.913,292,280.25,279.89,264,264,264,263,257,255,255,248,248,248.957,248,245,245,238,238,221.2,219,212,203.43,189,179,179,173,172,172,173,173,180,180,197,197,203.286,206.295,214,224.508,241,242,246,248,263,263,268.29,281,291,291,305,305,307,328,329,332,332,332,332,331.015,334,334,334,333,330.937,330,330,330,330,327,322,321,321,315.69,316,NA,326,326,326,325,325),
y=c(263,264,264,264,274,274,279,279,279,283,283,283,289,289,290,304,311,311,311,311,316,318,318,318,320.129,336.062,334,334,337,343,343,355.085,365,365,368,370,371,371,375.333,384,384,384,383,383,379.821,384,384,384,381.818,381,381,381,381,392,392,393,394,394,394,394,393,391,391,383,382.111,381,381,375,374,374,374,368,368,368,354.551,346.037,341,331,321,324,324,325,333,322.625,308.439,304,304,303,292.935,279.634,266,266,262,262,261,261,261,166,166,167,168,172.947,182,182,187,187,191,191,192,206,209,209,215,215,215,215,215,221.909,226,226,233.7,251,263,271,272,272,278.176,281,281,282,282,281,281,277.696,274,274,273.932,264,264,264,263,261,261,261,262,262,263.913,264,263,263,260,260,251.6,251,247,241.547,239,231,231,227,225,224,209,209,202,202,193,193,195.286,195.486,196,203.706,188,187,185,185,187,187,187.962,176,168,168,165,165,165,289,290,294,294,296,296,297.084,314,314,314,315,315.688,311,311,311,311,304,290,289,289,286.549,285,NA,251,251,251,250.5,246)
    );

};


# textbox function
# based on plotrix's textbox, modified to provide a variable-size background
# replaces hyphens with soft hyphens to work around the
# too-clever-by-half tendencies of R's PDF graphics drive
textbox <- function (x, y, textlist, justify = c("l", "c", "r"), cex = 1,
    leading = 0.5, box = TRUE, adj = c(0, 0), font = NULL, vfont = NULL,
    col = NULL, border = NULL, fill = NA, density = NULL, angle = 45,
    lty = par("lty"), lwd = par("lwd"), margin = 0)
{
    if (length(margin) == 1) {
        margin <- rep(margin, 4);
    } else if (length(margin) == 2) {
        margin <- rep(margin, 2);
    }
    saveAdj <- par(adj = 0);
    textstr <- sub ('-', '\U{AD}', paste(textlist, collapse = " "));
    words <- strsplit(textstr, " ")[[1]];
    line.height <- strheight("hy", cex = cex, font = font, vfont = vfont) * (1 + leading);
    if (margin[2] > 0) x[1] <- x[1] + margin[2];
    if (margin[3] > 0) y <- y - margin[3];
    if (margin[4] > 0) x[2] <- x[2] - margin[4];
    if (x[1] >= x[2]) x[2] <- x[1] + diff(par("usr")[1:2]) * 0.1;
    x.len <- diff(x);
    y.pos <- y;
    x.pos <- x[1];
    adj2 <- c(0, 1);
    if (justify[1] == "c") {
        x.pos <- x.pos + x.len/2;
        adj2[1] <- 0.5;
    }
    else if (justify[1] == "r") {
        x.pos <- x.pos + x.len;
        adj2[1] <- 1;
    }
    curword <- 1;
    lineData <- list();
    while (curword <= length(words)) {
        curline <- "";
        curline <- paste(curline, words[curword]);
        curword <- curword + 1;
        while (strwidth(paste(curline, words[curword]), cex = cex,
            font = font, vfont = vfont) < x.len && !is.na(words[curword])) {
            curline <- paste(curline, words[curword]);
            curword <- curword + 1;
        }
        lineData[[1+length(lineData)]] <- list(x.pos, y.pos, curline);
        y.pos <- y.pos - line.height;
    }
    if (box) {
        xbox <- x;
        ybox <- c(y.pos, y);
        ybox[1] <- ybox[1] - abs(margin[1]);
        xbox[1] <- xbox[1] - abs(margin[2]);
        ybox[2] <- ybox[2] + abs(margin[3]);
        xbox[2] <- xbox[2] + abs(margin[4]);
        rect(xbox[1], ybox[1], xbox[2], ybox[2], border = border,
            col = fill, density = density, angle = angle, lty = lty,
            lwd = lwd);
        y.pos <- ybox[1];
    }
    for (i in 1:length(lineData)) {
        text(
            lineData[[i]][[1]], lineData[[i]][[2]],
            lineData[[i]][[3]],
            adj = adj + adj2, cex = cex,
            col = col, font = font, vfont = vfont);
    }
    par(saveAdj);
    return(y.pos);
};

library(shape);

plot.dno.map <- function (
    l,
    colour.maker = function (i) { hsv(0.0025*i, 0.6+0.004*i, 1-0.0025*i); },
    file.name = 'DNO map', file.type = 'pdf',
    legend.show = TRUE, legend.digit = 0,
    map = map.England.Wales.Scotland(),
    maxcol = NA, maxcol.maker = function (v) { max(v, na.rm=T); },
    mincol = NA, mincol.maker = function (v) { min(v, na.rm=T); },
    number.show = TRUE, number.format = '%2.1f',
    title = NA, option.names = c(), box = NA
) {

    if (is.data.frame(l)) {
        v <- l;
        numMaps<-length(v);
    }
    else {
        if (!is.list(l)) {
            numMaps<-1;
            l<-list(l);
        } else numMaps<-length(l);
        v<-data.frame();
        for (i in (1:numMaps)) {
            rn <- names(l[[i]]);
            if (length(rn) > 0) {
                set <- rep(NA, length(dno.areas));
                for (a in 1:length(set)) {
                    t <- (1:length(rn))[rn==dno.areas[a]];
                    if (length(t)==1) set[a] <- t[1];
                }
                l[[i]] <- l[[i]][set];
            }
            else {
                l[[i]] <- rep(NA, length(dno.areas));
            }
        }
        v <- data.frame(l);
        rownames(v) <- dno.areas;
    }
    if (length(option.names)>0) colnames(v) <- option.names;

    if (!is.na(file.name)) {
        if (file.type == 'Twitter') {
            # file.type <- 600;
            if (numMaps == 2) file.type <- 600 else file.type <- 1024;
        } else if (file.type == 'iPad') {
            if (numMaps == 2) file.type <- 1536 else file.type <- 2048;
        } else if (file.type == 'mob1080') {
            if (numMaps == 2) file.type <- 1080 else file.type <- 1620;
        } else if (file.type == 'mob720') {
            if (numMaps == 2) file.type <- 720 else file.type <- 1080;
        } else if (file.type == 'iPhone') {
            if (numMaps == 2) file.type <- 640 else file.type <- 960;
        } else if (file.type == 'Doc' | file.type == 'Word') {
            # 192 dpi up to 6.25" wide by 9.375" tall
            if (numMaps == 1) file.type <- 1800 else file.type <- 1200;
        } else if ( file.type == 'Slide' | file.type == 'Slides' ) {
            # 192 dpi up to 10" by 6.7" images for 10" by 7.5" slides
            if (numMaps == 3) file.type <- 1920 else file.type <- 1280;
        } else if ( file.type == '1080p' | file.type == 'FullHD' ) {
            if (numMaps == 3) file.type <- 1920 else file.type <- 1080;
        } else if ( file.type == '720p' | file.type == 'HD' ) {
            if (numMaps == 3) file.type <- 1280 else file.type <- 720;
        } else if (file.type == 'Retina15') {
            if (numMaps == 3) file.type <- 2700 else file.type <- 1800;
        }
        if ( file.type == 'pdfa4' | file.type == 'PDFA4' ) {
            filename<-paste(file.name, '.pdf', sep='');
            pdf(filename, width=11.69, height=8.27);
        } else if ( file.type == 'pdf' | file.type == 'PDF' ) {
            filename<-paste(file.name, '.pdf', sep='');
            if (numMaps == 1) pdf(filename, height=11, width=7.58) else
            if (numMaps == 2) pdf(filename, width=7.58, height=7.58) else
            if (numMaps == 3) pdf(filename, width=11, height=7.58) else
            pdf(filename, width=11.69, height=8.27); # PDF full A4
        } else if ( file.type == 'svg' | file.type == 'SVG' ) {
            filename<-paste(file.name, '.svg', sep='');
            if (numMaps == 1) svg(filename, height=11, width=7.58) else
            if (numMaps == 2) svg(filename, width=7.58, height=7.58) else
            if (numMaps == 3) svg(filename, width=11, height=7.58);
        } else if ( file.type == 'jpg' | file.type == 'jpeg' | file.type == 'JPG' | file.type == 'JPEG' ) {
            file.type <- 2048;
            filename<-paste(file.name, '.jpeg', sep='');
            if (numMaps == 1) jpeg(filename, width=file.type*9/16, height=file.type, res=file.type/11) else
            if (numMaps == 2) jpeg(filename, width=file.type, height=file.type, res=file.type/7.58) else
            if (numMaps == 3) jpeg(filename, width=file.type, height=file.type*9/16, res=file.type/11);
        } else {
            file.type <- as.integer(file.type);
            filename<-paste(file.name, '.png', sep='');
            if (numMaps == 1) png(filename, width=file.type*9/16, height=file.type, res=file.type/11) else
            if (numMaps == 2) png(filename, width=file.type, height=file.type, res=file.type/7.58) else
            if (numMaps == 3) png(filename, width=file.type, height=file.type*9/16, res=file.type/11);
        }
    }

    minx<-min(map$x, na.rm=T);
    maxx<-max(map$x, na.rm=T);
    miny<-min(map$y, na.rm=T)-20;
    maxy<-max(map$y, na.rm=T);
    if(maxy<1000)maxy<-maxy+200;
    shift<-(maxx-minx)*(1:numMaps - 1);
    if (is.na(mincol)) mincol<-mincol.maker(v);
    if (is.na(maxcol)) maxcol<-maxcol.maker(v);
    if (maxcol-mincol<0.02) {
        mincol <- mincol-0.01;
        maxcol <- maxcol+0.01;
    }
    getcol<-function(v) {
        i<-floor(101*(maxcol-v)/(maxcol-mincol));
        if (is.na(i)) {
            "grey";
        } else {
            if (i<0) i<-0;
            if (i>100) i<-100;
            colour.maker(i);
        }
    };
    xrange<-c(min(shift)+minx, max(shift)+maxx)
    yrange<-c(miny, maxy);
    par(mar=c(0, 0, 0, 0));
    plot(xrange, yrange, asp=1, pch='', bty='n', frame.plot=F, ann=F, axes=F, xaxt='n', yaxt='n');
    for (g in 1:numMaps) {
        for (a in 1:14) {
            if (length(map$z[map$z == a])>0) {
                polypath(shift[g]+map$x[map$z == a], map$y[map$z == a], col=getcol(v[[g]][a]), rule="evenodd", lwd=0.2, fg="black");
                if (number.show) text(shift[g]+mean(map$x[map$z == a], na.rm=T), mean(map$y[map$z == a], na.rm=T), sprintf(number.format, v[[g]][a]), cex=0.75);
            }
        }
        if (numMaps>1) text(shift[g]+0.5*(maxx+minx), miny, names(v)[g], cex=1.25, font=2);
    }
    top<-max(yrange);
    bot<-top;
    if (numMaps == 1) prop<-c(0, 0.85) else prop<-c(0, 0.75);
    xr<-max(xrange)*prop+min(xrange)*(1-prop);
    mar<-c(4, 4, 8, 4);
    cex<-1.25;
    if (!is.na(title)) {
        bot<-textbox(xr, top, title, border="white", margin=mar, cex=cex, font=2, fill="white");
    }
    if (numMaps == 1) prop<-c(0.02, 0.77) else prop<-c(0.02, 0.58);
    xr<-max(xrange)*prop+min(xrange)*(1-prop);
    top<-bot-20;
    bot<-top;
    mar<-c(4, 4, 8, 4);
    cex<-1.0;
    if (!is.na(box[1])) {
        bot<-textbox(xr, bot, box, fill="white", margin=mar, cex=cex);
    }

    if (legend.show) {
        if (maxcol-mincol>70) { quantum <- 50; }
        else if (maxcol-mincol>19) { quantum <- 10; }
        else if (maxcol-mincol>7) { quantum <- 5; }
        else if (maxcol-mincol>1) { quantum <- 1; }
        else if (maxcol-mincol>0.2) { quantum <- 0.2; }
        else { quantum <- 0.1; }
        if (quantum < 0.5) {
            legend.digit <- 2;
        }
        minmax <- c(floor(mincol/quantum), ceiling(maxcol/quantum))*quantum;
        colorlegend(
            col=sapply(0.01*(minmax[1]*(100:0)+minmax[2]*(0:100)), getcol),
            minmax, zlevels=4,
            posx=c(0.95,0.975), posy=c(.7,.95), left=T,
            digit=legend.digit
        );
    }

    if (!is.na(file.name)) graphics.off();

};
